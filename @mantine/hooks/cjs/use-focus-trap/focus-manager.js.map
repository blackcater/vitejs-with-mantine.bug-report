{"version":3,"file":"focus-manager.js","sources":["../../src/use-focus-trap/focus-manager.ts"],"sourcesContent":["import { findTabbableDescendants } from './tabbable';\n\nconst focusLaterElements: HTMLElement[] = [];\nlet focusElement: HTMLElement = null;\nlet needToFocus = false;\n\nfunction handleBlur() {\n  needToFocus = true;\n}\n\nfunction handleFocus() {\n  if (needToFocus) {\n    needToFocus = false;\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (!focusElement) {\n      return;\n    }\n\n    if (focusElement.contains(document.activeElement)) {\n      return;\n    }\n\n    const el = findTabbableDescendants(focusElement)[0] || focusElement;\n    el.focus();\n  }\n}\n\nexport function markForFocusLater() {\n  focusLaterElements.push(document.activeElement as HTMLElement);\n}\n\nexport function returnFocus() {\n  let toFocus = null;\n  try {\n    toFocus = focusLaterElements.pop();\n    if (toFocus) toFocus.focus();\n  } catch (e) {\n    // eslint-disable-next-line no-console\n    console.warn(\n      [\n        '[@mantine/hooks/use-focus-trap] Focus was returned to',\n        toFocus,\n        'but dom node does not exist',\n      ].join(' ')\n    );\n  }\n}\n\nexport function setupScopedFocus(element: HTMLElement) {\n  focusElement = element;\n  document.addEventListener('focusout', handleBlur, false);\n  document.addEventListener('focusin', handleFocus, true);\n}\n\nexport function teardownScopedFocus() {\n  focusElement = null;\n  document.removeEventListener('focusout', handleBlur);\n  document.removeEventListener('focusin', handleFocus);\n}\n"],"names":["findTabbableDescendants"],"mappings":";;;;;;AAEA,MAAM,qBAAoC;AAC1C,IAAI,eAA4B;AAChC,IAAI,cAAc;AAElB,sBAAsB;AACpB,gBAAc;AAAA;AAGhB,uBAAuB;AACrB,MAAI,aAAa;AACf,kBAAc;AAEd,QAAI,CAAC,cAAc;AACjB;AAAA;AAGF,QAAI,CAAC,cAAc;AACjB;AAAA;AAGF,QAAI,aAAa,SAAS,SAAS,gBAAgB;AACjD;AAAA;AAGF,UAAM,KAAKA,iCAAwB,cAAc,MAAM;AACvD,OAAG;AAAA;AAAA;6BAI6B;AAClC,qBAAmB,KAAK,SAAS;AAAA;uBAGL;AAC5B,MAAI,UAAU;AACd,MAAI;AACF,cAAU,mBAAmB;AAC7B,QAAI;AAAS,cAAQ;AAAA,WACd,GAAP;AAEA,YAAQ,KACN;AAAA,MACE;AAAA,MACA;AAAA,MACA;AAAA,MACA,KAAK;AAAA;AAAA;0BAKoB,SAAsB;AACrD,iBAAe;AACf,WAAS,iBAAiB,YAAY,YAAY;AAClD,WAAS,iBAAiB,WAAW,aAAa;AAAA;+BAGd;AACpC,iBAAe;AACf,WAAS,oBAAoB,YAAY;AACzC,WAAS,oBAAoB,WAAW;AAAA;;;;;;;"}